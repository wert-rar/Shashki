<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Шашки</title>
    <script type="text/javascript">
      // render board
      // render pieces
      // move pieces by mouse
      // requests to server
      // Christofor

      // settings
      let cell_size = 25;
      let steps = ["Ход белых", "Ход черных"];
      let status = {
        w1: "Ход белых",
        b1: "Ход черных",
        w2: "Нельзя двигать фигуру, сейчас ход белых",
        b2: "Нельзя двигать фигуру, сейчас ход черных",
        w3: "Победили белые",
        b3: "Победили черные",
      };
      let colors = {
        1: "rgb(0,0,0)",
        0: "rgb(255,255,255)",
      };
      let b_colors = {
        1: "#DA7422",
        0: "#FFFBDB",
      };
      let pieces = [
        { color: 0, x: 1, y: 0, mode: "p" },
        { color: 1, x: 2, y: 1, mode: "p" },
        { color: 1, x: 3, y: 0, mode: "q" },
        // {"color": "w", "x":1, "y": 0, "mode":"p"},
        // {"color": "w", "x":2, "y": 1, "mode":"p"},
        // {"color": "w", "x":3, "y": 0, "mode":"p"},
        // {"color": "w", "x":0, "y": 1, "mode":"p"},
        // {"color": "w", "x":0, "y": 0, "mode":"p"},
        // {"color": "w", "x":0, "y": 1, "mode":"p"},
        // {"color": "w", "x":0, "y": 0, "mode":"p"},
        // {"color": "w", "x":0, "y": 0, "mode":"p"},
        // {"color": "w", "x":0, "y": 1, "mode":"p"},
        // {"color": "w", "x":0, "y": 0, "mode":"p"},
        // {"color": "w", "x":0, "y": 0, "mode":"p"},
        // {"color": "w", "x":0, "y": 0, "mode":"p"},
        // {"color": "w", "x":0, "y": 0, "mode":"p"},
        // {"color": "w", "x":0, "y": 0, "mode":"p"},
        // {"color": "w", "x":0, "y": 0, "mode":"p"},
        // {"color": "w", "x":0, "y": 0, "mode":"p"},
      ];

      function draw_piece_by_type(ctx, piece) {
        ctx.fillStyle = colors[piece.color];
        ctx.strokeStyle = colors[piece.color ? 0 : 1];
        const centerX = cell_size * (piece.x + 1.5);
        const centerY = cell_size * (piece.y + 1.5);
        const radius = (cell_size / 2) * 0.8;

        ctx.beginPath();
        ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI, false);
        ctx.fill();
        ctx.lineWidth = 3;
        ctx.stroke();
        if (piece.mode == "p") {
          ctx.beginPath();
          ctx.arc(centerX, centerY, radius * 0.7, 0, 2 * Math.PI, false);
          ctx.lineWidth = 3;
          ctx.stroke();
        } else {
          ctx.strokeStyle = "gold";
          ctx.beginPath();
          ctx.arc(centerX, centerY, radius * 0.5, 0, 2 * Math.PI, false);
          ctx.lineWidth = 6;
          ctx.stroke();
        }
      }

      function win(stat) {
        if (stat == "b3")
          document.getElementsByClassName("board")[0].innerHTML =
            "<div class='win'> Победили черные</div>";
        else
          document.getElementsByClassName("board")[0].innerHTML =
            "<div class='win'> Победили белые</div>";
      }

      // render code
      function adjustScreen() {
        const canvas = document.getElementById("board");
        const ctx = canvas.getContext("2d");
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight * 0.95;
        cell_size = canvas.height * 0.1;
        console.log(cell_size);
      }
      function onLoad() {
        adjustScreen();
        render_Board();
        render_Pieces();
      }

      function render_Board() {
        document.getElementById("status").innerHTML = status["w1"];
        document.getElementById("step").innerHTML = steps[0];
        const canvas = document.getElementById("board");
        const ctx = canvas.getContext("2d");
        ctx.fillStyle = "white";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = "black";
        ctx.lineWidth = 2;
        ctx.strokeRect(cell_size, cell_size, cell_size * 8, cell_size * 8);
        let step = 0;
        for (let i = 0; i < 8; i++) {
          for (let j = 0; j < 8; j++) {
            ctx.fillStyle = b_colors[step % 2];

            ctx.fillRect(
              cell_size + cell_size * j,
              cell_size + cell_size * i,
              cell_size,
              cell_size
            );
            step++;
          }
          step++;
        }
      }
      function render_Pieces() {
        const canvas = document.getElementById("board");
        const ctx = canvas.getContext("2d");
        for (let i = 0; i < pieces.length; i++)
          draw_piece_by_type(ctx, pieces[i]);
      }
    </script>
    <style>
      .header {
        color: white;
        font-size: 24pt;
        text-align: center;
        background-color: rgb(225, 112, 14);
        height: 5%;
        margin: 0px;
        padding: 0px;
      }

      .board {
        align-items: center;
        height: 100%;
      }

      .win {
        color: white;
        font-size: 24pt;
        background-color: #8fec8d;
        text-align: center;
        height: 80%;
      }
    </style>
  </head>
  <body onload="onLoad()">
    <div class="header">
      <div class="status" id="status">Сейчас ходят белые</div>
      <div class="step" id="step">Ход белых</div>
    </div>
    <div class="board">
      <canvas id="board" width="1400" height="500"></canvas>
    </div>
  </body>
</html>
